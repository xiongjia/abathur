# grunt config

# settings (e.g. folder name, server port numbers)
abathur:
  dist: &dist 'dist'
  assets: &assets 'dist/assets'
  output: &output 'output'
  mainCSS: &mainCSS 'dist/assets/css/main_v0.1.css'
  mainJS: &mainJS 'dist/assets/js/main_v0.1.js'
  rsyncSrc: &rsyncSrc './dist/'
  rsyncDest: &rsyncDest 'lexj@xj-labs.net:xj-labs.net'
  siteRoot: &siteRoot 'http://www.xj-labs.net'

# task config - bower
gruntBower: &gruntBower
  install:
    options:
      install: true
      copy: true
      verbose: true
      targetDir: './bower_components'

# task config - jshint
gruntJSHint: &gruntJSHint
  options:
    jshintrc: '.jshintrc'
  gruntfile:
    src: 'Gruntfile.js'
  config:
    src:
      - 'content/assets/js/abathur.js'
      - 'content/assets/js/ganalytics.js'

# task config - clean
gruntClean: &gruntClean
  - *dist

# task config - copy
gruntCopy: &gruntCopy
  content:
    expand: true
    cwd: *output
    src:
      - '**/*.html'
    dest: *dist
  conf:
    src:
      - 'content/htaccess'
    dest: 'dist/.htaccess'
  fonts:
    expand: true
    cwd: 'bower_components/bootstrap/dist'
    src:
      - '**/*.{eot,svg,ttf,woff}'
    dest: *assets
  icon:
    src:
      - 'content/favicon.ico'
    dest: 'dist/favicon.ico'
  map:
    expand: true
    cwd: 'bower_components/bootstrap/dist/css'
    src:
      - '*.map'
    dest: 'dist/assets/css/'
  img:
    expand: true
    cwd: 'content/assets/img'
    src:
      - '*'
    dest: 'dist/assets/img/'
  data:
    expand: true
    cwd: 'content/assets/data'
    src:
      - '*.png'
    dest: 'dist/assets/data/'

# task config - concat
gruntConcat: &gruntConcat
  css:
    src:
      - 'bower_components/bootstrap/dist/css/bootstrap.css'
      - 'content/assets/css/abathur.css'
    dest: *mainCSS
  js:
    src:
      - 'bower_components/jquery/jquery.js'
      - 'content/assets/js/abathur.js'
      - 'content/assets/js/ganalytics.js'
    dest: *mainJS

# task config - cssmin
gruntCssmin: &gruntCssmin
  minify:
    src:
      - *mainCSS
    dest: *mainCSS

# task config - uglify
gruntUglify: &gruntUglify
  dist:
    src: *mainJS
    dest: *mainJS

# task config - htmlmin
gruntHtmlmin: &gruntHtmlmin
  dist:
    options:
      removeComments: true
      collapseWhitespace: true 
    files:
      - 
        expand: true
        cwd: 'dist'
        src: '**/*.html'
        dest: 'dist'

# task config - watch
gruntWatch: &gruntWatch
  content:
    files:
      - 'output/**/*.html'
    tasks:
      - 'copy:content'
      - 'htmlmin'
    options:
      spawn: false

# task config - connect
gruntConnect: &gruntConnect
  server:
    options:
      port: 9001
      debug: true
      base: 'dist'

# task config - imagemin
gruntImagemin: &gruntImagemin
  dynamic:
    options:
      optimizationLevel: 3
    files:
      - expand: true
        cwd: 'dist/assets/data/'
        src:
          - '**/*.png'
        dest: 'dist/assets/data/'
      - expand: true
        cwd: 'dist/assets/img/'
        src:
          - '**/*.png'
        dest: 'dist/assets/img/'

# task config - rsync
gruntRsync: &gruntRsync
  options:
    args:
      - '--verbose'
    recursive: true
  dist:
    options:
      src: *rsyncSrc
      dest: *rsyncDest

# task config - sitemap
gruntSitemap: &gruntSitemap
  dist:
    pattern:
      - 'dist/**/*.html'
    siteRoot: 'dist'
    homepage: *siteRoot
    changefreq: 'weekly' 

# task config - htmlhint
gruntHtmlhint: &gruntHtmlhint
  pages:
    src:
      - 'dist/**/*.html'

# task config - checkPages
gruntCheckPages: &gruntCheckPages
  dev:
    options:
      checkLinks: false
      onlySameDomain: true
      queryHashes: true
      noRedirects: true
      noLocalLinks: true
      noEmptyFragments: false
      checkXhtml: false
      checkCaching: true
      checkCompression: false
      maxResponseTime: 2000
      summary: true
      pageUrls:
        - 'http://localhost:9001/'
        - 'http://localhost:9001/favicon.ico'
        - 'http://localhost:9001/sitemap.xml'
        - 'http://localhost:9001/index.html'
        - 'http://localhost:9001/about.html'
        - 'http://localhost:9001/missing.html'
        - 'http://localhost:9001/forbidden.html'
        - 'http://localhost:9001/assets/css/main_v0.1.css'
        - 'http://localhost:9001/assets/js/main_v0.1.js'
        - 'http://localhost:9001/assets/data/ab-request.png'
        - 'http://localhost:9001/assets/img/ab-cluster-test.png'
        - 'http://localhost:9001/dev/ab.html'
        - 'http://localhost:9001/dev/bookmarks.html'
        - 'http://localhost:9001/dev/boost.html'
        - 'http://localhost:9001/dev/scratch.html'
        - 'http://localhost:9001/dev/shell.html'
        - 'http://localhost:9001/dev/bat.html'
        - 'http://localhost:9001/dev/tips.html'
        - 'http://localhost:9001/dev/vim.html'
        - 'http://localhost:9001/dev/vim-fanfou.html'
        - 'http://localhost:9001/dev/win-uia.html'
        - 'http://localhost:9001/game/ingress.html'
        - 'http://localhost:9001/game/minecraft.html'
        - 'http://localhost:9001/general/emoticon.html'
        - 'http://localhost:9001/general/txt.html'

# grunt config root
root:
  bower: *gruntBower
  jshint: *gruntJSHint
  clean: *gruntClean
  copy: *gruntCopy
  concat: *gruntConcat
  cssmin: *gruntCssmin
  uglify: *gruntUglify
  htmlmin: *gruntHtmlmin
  watch: *gruntWatch
  connect: *gruntConnect
  imagemin: *gruntImagemin
  rsync: *gruntRsync
  sitemap: *gruntSitemap
  checkPages: *gruntCheckPages
  htmlhint: *gruntHtmlhint
